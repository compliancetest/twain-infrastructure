{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Resources" : 
  {



						
						"ecsTaskXwebXwww" : {
						  "Type" : "AWS::ECS::TaskDefinition",
						  "Properties" : {
							"ContainerDefinitions" : [
								{
								  "Name" : "web-www",
								  		"Image" : "docker.ct01.gosource.com.au/website/4bed82d36b27e9fa5766f9a00836913b89262ee2",
								  "Environment" : [
										{
											"Name" : "VPC",
											"Value" : "vpc-ca676baf"
										},
										{
											"Name" : "IGW",
											"Value" : "igw-b2bec1d7"
										},
										{
											"Name" : "MGMT_NAT",
											"Value" : "sg-76e10111"
										},
										{
											"Name" : "ELB_A",
											"Value" : "subnet-d9c9fdae"
										},
										{
											"Name" : "ELB_B",
											"Value" : "subnet-e82b388d"
										},
										{
											"Name" : "ELB_C",
											"Value" : "subnet-06db965f"
										},
										{
											"Name" : "WEB_A",
											"Value" : "subnet-ddc9fdaa"
										},
										{
											"Name" : "WEB_B",
											"Value" : "subnet-ea2b388f"
										},
										{
											"Name" : "WEB_C",
											"Value" : "subnet-39db9660"
										},
										{
											"Name" : "APP_A",
											"Value" : "subnet-dac9fdad"
										},
										{
											"Name" : "APP_B",
											"Value" : "subnet-f42b3891"
										},
										{
											"Name" : "APP_C",
											"Value" : "subnet-04db965d"
										},
										{
											"Name" : "DB_A",
											"Value" : "subnet-dcc9fdab"
										},
										{
											"Name" : "DB_B",
											"Value" : "subnet-f52b3890"
										},
										{
											"Name" : "DB_C",
											"Value" : "subnet-05db965c"
										},
										{
											"Name" : "MGMT_A",
											"Value" : "subnet-dbc9fdac"
										},
										{
											"Name" : "MGMT_B",
											"Value" : "subnet-eb2b388e"
										},
										{
											"Name" : "MGMT_C",
											"Value" : "subnet-07db965e"
										},
										{
											"Name" : "ELB_WWW",
											"Value" : "twain-preprod-elb-www"
										},
										{
											"Name" : "ELB_WWW_DNS",
											"Value" : "twain-preprod-elb-www-1058764002.us-west-2.elb.amazonaws.com"
										},
										{
											"Name" : "ELB_AGENT",
											"Value" : "twain-preprod-elb-agent"
										},
										{
											"Name" : "ELB_AGENT_DNS",
											"Value" : "twain-preprod-elb-agent-1946204208.us-west-2.elb.amazonaws.com"
										},
										{
											"Name" : "ELB_SIM",
											"Value" : "twain-preprod-elb-sim"
										},
										{
											"Name" : "ELB_SIM_DNS",
											"Value" : "twain-preprod-elb-sim-1706974032.us-west-2.elb.amazonaws.com"
										},
										{
											"Name" : "WEB_WWW",
											"Value" : "twain-preproduction-solution-ecsXwebXwww-1A9QFCSKGFR79"
										},
										{
											"Name" : "WEB_WWW_SERVICE",
											"Value" : "twain-preproduction-solution-roleXwebXwwwXservice-I0ZOMOE8X6OA"
										},
										{
											"Name" : "WEB_WWW",
											"Value" : "twain-preproduction-solution-roleXwebXwwwXinstance-19GATG8LCGA65"
										},
										{
											"Name" : "WEB_WWW_SERVICE_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-preproduction-solution-roleXwebXwwwXservice-I0ZOMOE8X6OA"
										},
										{
											"Name" : "APP_AGENT",
											"Value" : "twain-preproduction-solution-ecsXappXagent-1GCZMR513SY6O"
										},
										{
											"Name" : "APP_AGENT_SERVICE",
											"Value" : "twain-preproduction-solutio-roleXappXagentXservice-1XKD7T8ZDIMXV"
										},
										{
											"Name" : "APP_AGENT",
											"Value" : "twain-preproduction-soluti-roleXappXagentXinstance-586EZZXHXMAY"
										},
										{
											"Name" : "APP_AGENT_SERVICE_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-preproduction-solutio-roleXappXagentXservice-1XKD7T8ZDIMXV"
										},
										{
											"Name" : "APP_SIM",
											"Value" : "twain-preproduction-solution-ecsXappXsim-1NJI67KA129O"
										},
										{
											"Name" : "APP_SIM_SERVICE",
											"Value" : "twain-preproduction-solution-roleXappXsimXservice-514ODYECA5M9"
										},
										{
											"Name" : "APP_SIM",
											"Value" : "twain-preproduction-solution-roleXappXsimXinstance-FO0KR37MV74N"
										},
										{
											"Name" : "APP_SIM_SERVICE_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-preproduction-solution-roleXappXsimXservice-514ODYECA5M9"
										},
										{
											"Name" : "DB_MYSQL_DNS",
											"Value" : "twain-preproduction-database-mysql.cxwpegmisug9.us-west-2.rds.amazonaws.com"
										},
										{
											"Name" : "DB_MYSQL_PORT",
											"Value" : "3306"
										},
										{
											"Name" : "DB_MYSQL_DATABASENAME",
											"Value" : "twain"
										},
										{
											"Name" : "DB_MYSQL_USERNAME",
											"Value" : "root"
										},
										{
											"Name" : "DB_MYSQL_PASSWORD",
											"Value" : "HHFRrYKvSCB5ZVdDTUvS"
										},
										{
											"Name" : "ENVIRONMENT",
											"Value" : "preproduction"
										},
										{
											"Name" : "CONFIGURATION",
											"Value" : ""
										},
										{
											"Name" : "CONFIGURATION_REFERENCE",
											"Value" : "f22fd90cf6b8d6060670a06ea1e608f7ea5a4b5f"
										},
										{
											"Name" : "BUILD_REFERENCE",
											"Value" : "4bed82d36b27e9fa5766f9a00836913b89262ee2"
										},
										{
											"Name" : "SMTP_HOST",
											"Value" : "email-smtp.us-west-2.amazonaws.com"
										},
										{
											"Name" : "SMTP_PORT",
											"Value" : "587"
										},
										{
											"Name" : "SMTP_USER",
											"Value" : "AKIAIWAVUHSRJUWALCEA"
										},
										{
											"Name" : "SMTP_PASSWORD",
											"Value" : "AuDVfgFVjhvLVFY99v95V5bhMmYPJSueE7vUDl7fqWSA"
										},
										{
											"Name" : "SMTP_FROM",
											"Value" : "noreply@twain.gosource.com.au"
										}
								  ],
								  "PortMappings" : [
										{
											"ContainerPort" : 80,
											"HostPort" : 80
										}
								  ],
								  "MountPoints": [
										{
											"SourceVolume": "uploads",
											"ContainerPath": "/var/www/html/wp-content/uploads",
											"ReadOnly": false
										}
								  ],
								  "Essential" : true,
								  "Memory" : "3686",
								  "Cpu" : "2048"
								}
							],
							"Volumes" : [
								{
									"Host": {
										"SourcePath": "/project/uploads"
										},
										"Name": "uploads"
								}
							]
						  }
						},
						"ecsServiceXwebXwww" : {
						  "Type" : "AWS::ECS::Service",
						  "Properties" : {
							"Cluster" : "twain-preproduction-solution-ecsXwebXwww-1A9QFCSKGFR79",
							"DesiredCount" : "1",
							"LoadBalancers" : [
									{
										"LoadBalancerName" : "twain-preprod-elb-www",
										"ContainerName" : "web-www",
										"ContainerPort" : 80
									}
							],
							"Role" : "twain-preproduction-solution-roleXwebXwwwXservice-I0ZOMOE8X6OA",
							"TaskDefinition" : { "Ref" : "ecsTaskXwebXwww" }
						  }
						},
						"policyXwebXwwwXs3" : {
						  "Type": "AWS::IAM::Policy",
						  "Properties": {
							"PolicyDocument" : {
								"Version": "2012-10-17",
								"Statement": [
								  {
									"Resource": [
										"arn:aws:s3:::captures.twain.gosource.com.au/preproduction/*",
										"arn:aws:s3:::data.twain.gosource.com.au/*",
										"arn:aws:s3:::reference.twain.gosource.com.au/preproduction/*",
										"arn:aws:s3:::logs.twain.gosource.com.au/preproduction/*"
									],
									"Action": [
										"s3:*"
									],
									"Effect": "Allow"
								  }
								]
							},
							"PolicyName": "web-www-s3",
							"Roles" : [ "twain-preproduction-solution-roleXwebXwwwXinstance-19GATG8LCGA65"]
						  }
						},
						"policyXwebXwwwXcloudsearch" : {
						  "Type": "AWS::IAM::Policy",
						  "Properties": {
							"PolicyDocument" : {
								"Version": "2012-10-17",
								"Statement": [
								  {
									"Resource": [
										"arn:aws:cloudsearch:us-west-2:*:domain/twain-preproduction",
										"arn:aws:cloudsearch:us-west-2:*:domain/twain-fulltext-preproduction"
									],
									"Action": [
										"cloudsearch:*"
									],
									"Effect": "Allow"
								  }							]
							},
							"PolicyName": "web-www-cloudsearch",
							"Roles" : [ "twain-preproduction-solution-roleXwebXwwwXinstance-19GATG8LCGA65"]
						  }
						}




  }
}

