{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Resources" : 
  {




						
						"ecsTaskXappXagent" : {
						  "Type" : "AWS::ECS::TaskDefinition",
						  "Properties" : {
							"ContainerDefinitions" : [
								{
								  "Name" : "application-agent",
								  		"Image" : "docker.ct01.gosource.com.au/agent/16727864e86a74401ccc10d81be4dd460fabfdbd",
								  "Environment" : [
										{
											"Name" : "VPC",
											"Value" : "vpc-09031b6c"
										},
										{
											"Name" : "IGW",
											"Value" : "igw-bebcf0db"
										},
										{
											"Name" : "MGMT_NAT",
											"Value" : "sg-d920f1be"
										},
										{
											"Name" : "ELB_A",
											"Value" : "subnet-a0e8eed7"
										},
										{
											"Name" : "ELB_B",
											"Value" : "subnet-1ae70a7e"
										},
										{
											"Name" : "ELB_C",
											"Value" : "subnet-9cd18dc5"
										},
										{
											"Name" : "WEB_A",
											"Value" : "subnet-a1e8eed6"
										},
										{
											"Name" : "WEB_B",
											"Value" : "subnet-18e70a7c"
										},
										{
											"Name" : "WEB_C",
											"Value" : "subnet-99d18dc0"
										},
										{
											"Name" : "APP_A",
											"Value" : "subnet-a2e8eed5"
										},
										{
											"Name" : "APP_B",
											"Value" : "subnet-1fe70a7b"
										},
										{
											"Name" : "APP_C",
											"Value" : "subnet-9bd18dc2"
										},
										{
											"Name" : "DB_A",
											"Value" : "subnet-afe8eed8"
										},
										{
											"Name" : "DB_B",
											"Value" : "subnet-1be70a7f"
										},
										{
											"Name" : "DB_C",
											"Value" : "subnet-e6d18dbf"
										},
										{
											"Name" : "MGMT_A",
											"Value" : "subnet-a3e8eed4"
										},
										{
											"Name" : "MGMT_B",
											"Value" : "subnet-19e70a7d"
										},
										{
											"Name" : "MGMT_C",
											"Value" : "subnet-9dd18dc4"
										},
										{
											"Name" : "ELB_AGENT",
											"Value" : "twain-int-elb-agent"
										},
										{
											"Name" : "ELB_AGENT_DNS",
											"Value" : "twain-int-elb-agent-116460424.us-west-2.elb.amazonaws.com"
										},
										{
											"Name" : "APP_AGENT",
											"Value" : "twain-integration-soln-agent-ecsXappXagent-1TMYO3IOPQF4E"
										},
										{
											"Name" : "APP_AGENT",
											"Value" : "twain-integration-soln-agent-roleXappXagent-LXBW1YVBSE3S"
										},
										{
											"Name" : "APP_AGENT_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-integration-soln-agent-roleXappXagent-LXBW1YVBSE3S"
										},
										{
											"Name" : "APP_AGENT_SERVICE",
											"Value" : "twain-integration-soln-agen-roleXappXagentXservice-TEX0SFICZL1N"
										},
										{
											"Name" : "APP_AGENT_SERVICE_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-integration-soln-agen-roleXappXagentXservice-TEX0SFICZL1N"
										},
										{
											"Name" : "DB_MYSQL_DNS",
											"Value" : "twain-integration-database-mysql.cxwpegmisug9.us-west-2.rds.amazonaws.com"
										},
										{
											"Name" : "DB_MYSQL_PORT",
											"Value" : "3306"
										},
										{
											"Name" : "DB_MYSQL_DATABASENAME",
											"Value" : "twain"
										},
										{
											"Name" : "DB_MYSQL_USERNAME",
											"Value" : "root"
										},
										{
											"Name" : "DB_MYSQL_PASSWORD",
											"Value" : "9UCXN8dJe8zwq6pBz4cj"
										},
										{
											"Name" : "ELB_WWW",
											"Value" : "twain-int-elb-www"
										},
										{
											"Name" : "ELB_WWW_DNS",
											"Value" : "twain-int-elb-www-1519496209.us-west-2.elb.amazonaws.com"
										},
										{
											"Name" : "WEB_WWW",
											"Value" : "twain-integration-soln-website-ecsXwebXwww-82CCL0PUOHPE"
										},
										{
											"Name" : "WEB_WWW",
											"Value" : "twain-integration-soln-website-roleXwebXwww-NR72F0JLNML9"
										},
										{
											"Name" : "WEB_WWW_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-integration-soln-website-roleXwebXwww-NR72F0JLNML9"
										},
										{
											"Name" : "WEB_WWW_SERVICE",
											"Value" : "twain-integration-soln-websit-roleXwebXwwwXservice-15BIPWVU1PU1Y"
										},
										{
											"Name" : "WEB_WWW_SERVICE_ARN",
											"Value" : "arn:aws:iam::355178332009:role/twain-integration-soln-websit-roleXwebXwwwXservice-15BIPWVU1PU1Y"
										},
										{
											"Name" : "ENVIRONMENT",
											"Value" : "integration"
										},
										{
											"Name" : "CONFIGURATION",
											"Value" : ""
										},
										{
											"Name" : "CONFIGURATION_REFERENCE",
											"Value" : "c6dc76f73ec949a21cc3434ed584d09aee3cd03b"
										},
										{
											"Name" : "BUILD_REFERENCE",
											"Value" : "16727864e86a74401ccc10d81be4dd460fabfdbd"
										},
										{
											"Name" : "SMTP_HOST",
											"Value" : "email-smtp.us-west-2.amazonaws.com"
										},
										{
											"Name" : "SMTP_PORT",
											"Value" : "587"
										},
										{
											"Name" : "SMTP_USER",
											"Value" : "AKIAIWAVUHSRJUWALCEA"
										},
										{
											"Name" : "SMTP_PASSWORD",
											"Value" : "AuDVfgFVjhvLVFY99v95V5bhMmYPJSueE7vUDl7fqWSA"
										},
										{
											"Name" : "SMTP_FROM",
											"Value" : "noreply@twain.gosource.com.au"
										}
								  ],
								  "PortMappings" : [
										{
											"ContainerPort" : 9000,
											"HostPort" : 9000
										}
								  ],
								  "MountPoints": [
										{
											"SourceVolume": "uploads",
											"ContainerPath": "/var/www/html/wp-content/uploads",
											"ReadOnly": false
										}
								  ],
								  "Essential" : true,
								  "Memory" : "922",
								  "Cpu" : "1024"
								}
							],
							"Volumes" : [
								{
									"Host": {
										"SourcePath": "/project/uploads"
										},
										"Name": "uploads"
								}
							]
						  }
						},
						"ecsServiceXappXagent" : {
						  "Type" : "AWS::ECS::Service",
						  "Properties" : {
							"Cluster" : "twain-integration-soln-agent-ecsXappXagent-1TMYO3IOPQF4E",
							"DesiredCount" : "1",
							"LoadBalancers" : [
									{
										"LoadBalancerName" : "twain-int-elb-agent",
										"ContainerName" : "application-agent",
										"ContainerPort" : 9000
									}
							],
							"Role" : "twain-integration-soln-agen-roleXappXagentXservice-TEX0SFICZL1N",
							"TaskDefinition" : { "Ref" : "ecsTaskXappXagent" }
						  }
						},
						"policyXappXagentXs3" : {
						  "Type": "AWS::IAM::Policy",
						  "Properties": {
							"PolicyDocument" : {
								"Version": "2012-10-17",
								"Statement": [
								  {
									"Resource": [
										"arn:aws:s3:::captures.twain.gosource.com.au/integration/*",
										"arn:aws:s3:::data.twain.gosource.com.au/*",
										"arn:aws:s3:::reference.twain.gosource.com.au/integration/*",
										"arn:aws:s3:::logs.twain.gosource.com.au/integration/*"
									],
									"Action": [
										"s3:*"
									],
									"Effect": "Allow"
								  }
								]
							},
							"PolicyName": "app-agent-s3",
							"Roles" : [ "twain-integration-soln-agent-roleXappXagent-LXBW1YVBSE3S"]
						  }
						},
						"policyXappXagentXcloudsearch" : {
						  "Type": "AWS::IAM::Policy",
						  "Properties": {
							"PolicyDocument" : {
								"Version": "2012-10-17",
								"Statement": [
								  {
									"Resource": [
										"arn:aws:cloudsearch:us-west-2:*:domain/twain-integration",
										"arn:aws:cloudsearch:us-west-2:*:domain/twain-fulltext-integration"
									],
									"Action": [
										"cloudsearch:*"
									],
									"Effect": "Allow"
								  }							]
							},
							"PolicyName": "app-agent-cloudsearch",
							"Roles" : [ "twain-integration-soln-agent-roleXappXagent-LXBW1YVBSE3S"]
						  }
						}



  }
}

